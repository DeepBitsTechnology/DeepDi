#pragma once
#include <string>
#include <vector>

#ifdef EXPORT
#ifdef _MSC_VER
#define EXPORT_API __declspec(dllexport)
#else
#define EXPORT_API __attribute__((__visibility__("default")))
#endif // _MSC_VER
#else
#ifdef _MSC_VER
#define EXPORT_API __declspec(dllimport)
#else
#define EXPORT_API 
#endif // _MSC_VER
#endif // EXPORT


class Disassembler;

namespace dd
{
	struct Section
	{
		std::int64_t start;
		std::int64_t end;
		std::string name;
		bool writable;
		bool executable;
	};

	enum struct Mnemonic
	{
        INVALID,
        AAA,
        AAD,
        AAM,
        AAS,
        ADC,
        ADCX,
        ADD,
        ADDPD,
        ADDPS,
        ADDSD,
        ADDSS,
        ADDSUBPD,
        ADDSUBPS,
        ADOX,
        AESDEC,
        AESDECLAST,
        AESENC,
        AESENCLAST,
        AESIMC,
        AESKEYGENASSIST,
        AND,
        ANDN,
        ANDNPD,
        ANDNPS,
        ANDPD,
        ANDPS,
        ARPL,
        BEXTR,
        BLCFILL,
        BLCI,
        BLCIC,
        BLCMSK,
        BLCS,
        BLENDPD,
        BLENDPS,
        BLENDVPD,
        BLENDVPS,
        BLSFILL,
        BLSI,
        BLSIC,
        BLSMSK,
        BLSR,
        BNDCL,
        BNDCN,
        BNDCU,
        BNDLDX,
        BNDMK,
        BNDMOV,
        BNDSTX,
        BOUND,
        BSF,
        BSR,
        BSWAP,
        BT,
        BTC,
        BTR,
        BTS,
        BZHI,
        CALL,
        CBW,
        CDQ,
        CDQE,
        CLAC,
        CLC,
        CLD,
        CLDEMOTE,
        CLEVICT0,
        CLEVICT1,
        CLFLUSH,
        CLFLUSHOPT,
        CLGI,
        CLI,
        CLRSSBSY,
        CLTS,
        CLWB,
        CLZERO,
        CMC,
        CMOVB,
        CMOVBE,
        CMOVL,
        CMOVLE,
        CMOVNB,
        CMOVNBE,
        CMOVNL,
        CMOVNLE,
        CMOVNO,
        CMOVNP,
        CMOVNS,
        CMOVNZ,
        CMOVO,
        CMOVP,
        CMOVS,
        CMOVZ,
        CMP,
        CMPPD,
        CMPPS,
        CMPSB,
        CMPSD,
        CMPSQ,
        CMPSS,
        CMPSW,
        CMPXCHG,
        CMPXCHG16B,
        CMPXCHG8B,
        COMISD,
        COMISS,
        CPUID,
        CQO,
        CRC32,
        CVTDQ2PD,
        CVTDQ2PS,
        CVTPD2DQ,
        CVTPD2PI,
        CVTPD2PS,
        CVTPI2PD,
        CVTPI2PS,
        CVTPS2DQ,
        CVTPS2PD,
        CVTPS2PI,
        CVTSD2SI,
        CVTSD2SS,
        CVTSI2SD,
        CVTSI2SS,
        CVTSS2SD,
        CVTSS2SI,
        CVTTPD2DQ,
        CVTTPD2PI,
        CVTTPS2DQ,
        CVTTPS2PI,
        CVTTSD2SI,
        CVTTSS2SI,
        CWD,
        CWDE,
        DAA,
        DAS,
        DEC,
        DELAY,
        DIV,
        DIVPD,
        DIVPS,
        DIVSD,
        DIVSS,
        DPPD,
        DPPS,
        EMMS,
        ENCLS,
        ENCLU,
        ENCLV,
        ENDBR32,
        ENDBR64,
        ENQCMD,
        ENQCMDS,
        ENTER,
        EXTRACTPS,
        EXTRQ,
        F2XM1,
        FABS,
        FADD,
        FADDP,
        FBLD,
        FBSTP,
        FCHS,
        FCMOVB,
        FCMOVBE,
        FCMOVE,
        FCMOVNB,
        FCMOVNBE,
        FCMOVNE,
        FCMOVNU,
        FCMOVU,
        FCOM,
        FCOMI,
        FCOMIP,
        FCOMP,
        FCOMPP,
        FCOS,
        FDECSTP,
        FDISI8087_NOP,
        FDIV,
        FDIVP,
        FDIVR,
        FDIVRP,
        FEMMS,
        FENI8087_NOP,
        FFREE,
        FFREEP,
        FIADD,
        FICOM,
        FICOMP,
        FIDIV,
        FIDIVR,
        FILD,
        FIMUL,
        FINCSTP,
        FIST,
        FISTP,
        FISTTP,
        FISUB,
        FISUBR,
        FLD,
        FLD1,
        FLDCW,
        FLDENV,
        FLDL2E,
        FLDL2T,
        FLDLG2,
        FLDLN2,
        FLDPI,
        FLDZ,
        FMUL,
        FMULP,
        FNCLEX,
        FNINIT,
        FNOP,
        FNSAVE,
        FNSTCW,
        FNSTENV,
        FNSTSW,
        FPATAN,
        FPREM,
        FPREM1,
        FPTAN,
        FRNDINT,
        FRSTOR,
        FSCALE,
        FSETPM287_NOP,
        FSIN,
        FSINCOS,
        FSQRT,
        FST,
        FSTP,
        FSTPNCE,
        FSUB,
        FSUBP,
        FSUBR,
        FSUBRP,
        FTST,
        FUCOM,
        FUCOMI,
        FUCOMIP,
        FUCOMP,
        FUCOMPP,
        FWAIT,
        FXAM,
        FXCH,
        FXRSTOR,
        FXRSTOR64,
        FXSAVE,
        FXSAVE64,
        FXTRACT,
        FYL2X,
        FYL2XP1,
        GETSEC,
        GF2P8AFFINEINVQB,
        GF2P8AFFINEQB,
        GF2P8MULB,
        HADDPD,
        HADDPS,
        HLT,
        HSUBPD,
        HSUBPS,
        IDIV,
        IMUL,
        OP_IN,
        INC,
        INCSSPD,
        INCSSPQ,
        INSB,
        INSD,
        INSERTPS,
        INSERTQ,
        INSW,
        INT,
        INT1,
        INT3,
        INTO,
        INVD,
        INVEPT,
        INVLPG,
        INVLPGA,
        INVPCID,
        INVVPID,
        IRET,
        IRETD,
        IRETQ,
        JB,
        JBE,
        JCXZ,
        JECXZ,
        JKNZD,
        JKZD,
        JL,
        JLE,
        JMP,
        JNB,
        JNBE,
        JNL,
        JNLE,
        JNO,
        JNP,
        JNS,
        JNZ,
        JO,
        JP,
        JRCXZ,
        JS,
        JZ,
        KADDB,
        KADDD,
        KADDQ,
        KADDW,
        KAND,
        KANDB,
        KANDD,
        KANDN,
        KANDNB,
        KANDND,
        KANDNQ,
        KANDNR,
        KANDNW,
        KANDQ,
        KANDW,
        KCONCATH,
        KCONCATL,
        KEXTRACT,
        KMERGE2L1H,
        KMERGE2L1L,
        KMOV,
        KMOVB,
        KMOVD,
        KMOVQ,
        KMOVW,
        KNOT,
        KNOTB,
        KNOTD,
        KNOTQ,
        KNOTW,
        KOR,
        KORB,
        KORD,
        KORQ,
        KORTEST,
        KORTESTB,
        KORTESTD,
        KORTESTQ,
        KORTESTW,
        KORW,
        KSHIFTLB,
        KSHIFTLD,
        KSHIFTLQ,
        KSHIFTLW,
        KSHIFTRB,
        KSHIFTRD,
        KSHIFTRQ,
        KSHIFTRW,
        KTESTB,
        KTESTD,
        KTESTQ,
        KTESTW,
        KUNPCKBW,
        KUNPCKDQ,
        KUNPCKWD,
        KXNOR,
        KXNORB,
        KXNORD,
        KXNORQ,
        KXNORW,
        KXOR,
        KXORB,
        KXORD,
        KXORQ,
        KXORW,
        LAHF,
        LAR,
        LDDQU,
        LDMXCSR,
        LDS,
        LEA,
        LEAVE,
        LES,
        LFENCE,
        LFS,
        LGDT,
        LGS,
        LIDT,
        LLDT,
        LLWPCB,
        LMSW,
        LODSB,
        LODSD,
        LODSQ,
        LODSW,
        LOOP,
        LOOPE,
        LOOPNE,
        LSL,
        LSS,
        LTR,
        LWPINS,
        LWPVAL,
        LZCNT,
        MASKMOVDQU,
        MASKMOVQ,
        MAXPD,
        MAXPS,
        MAXSD,
        MAXSS,
        MFENCE,
        MINPD,
        MINPS,
        MINSD,
        MINSS,
        MONITOR,
        MONITORX,
        MONTMUL,
        MOV,
        MOVAPD,
        MOVAPS,
        MOVBE,
        MOVD,
        MOVDDUP,
        MOVDIR64B,
        MOVDIRI,
        MOVDQ2Q,
        MOVDQA,
        MOVDQU,
        MOVHLPS,
        MOVHPD,
        MOVHPS,
        MOVLHPS,
        MOVLPD,
        MOVLPS,
        MOVMSKPD,
        MOVMSKPS,
        MOVNTDQ,
        MOVNTDQA,
        MOVNTI,
        MOVNTPD,
        MOVNTPS,
        MOVNTQ,
        MOVNTSD,
        MOVNTSS,
        MOVQ,
        MOVQ2DQ,
        MOVSB,
        MOVSD,
        MOVSHDUP,
        MOVSLDUP,
        MOVSQ,
        MOVSS,
        MOVSW,
        MOVSX,
        MOVSXD,
        MOVUPD,
        MOVUPS,
        MOVZX,
        MPSADBW,
        MUL,
        MULPD,
        MULPS,
        MULSD,
        MULSS,
        MULX,
        MWAIT,
        MWAITX,
        NEG,
        NOP,
        NOT,
        OR,
        ORPD,
        ORPS,
        OP_OUT,
        OUTSB,
        OUTSD,
        OUTSW,
        PABSB,
        PABSD,
        PABSW,
        PACKSSDW,
        PACKSSWB,
        PACKUSDW,
        PACKUSWB,
        PADDB,
        PADDD,
        PADDQ,
        PADDSB,
        PADDSW,
        PADDUSB,
        PADDUSW,
        PADDW,
        PALIGNR,
        PAND,
        PANDN,
        PAUSE,
        PAVGB,
        PAVGUSB,
        PAVGW,
        PBLENDVB,
        PBLENDW,
        PCLMULQDQ,
        PCMPEQB,
        PCMPEQD,
        PCMPEQQ,
        PCMPEQW,
        PCMPESTRI,
        PCMPESTRM,
        PCMPGTB,
        PCMPGTD,
        PCMPGTQ,
        PCMPGTW,
        PCMPISTRI,
        PCMPISTRM,
        PCONFIG,
        PDEP,
        PEXT,
        PEXTRB,
        PEXTRD,
        PEXTRQ,
        PEXTRW,
        PF2ID,
        PF2IW,
        PFACC,
        PFADD,
        PFCMPEQ,
        PFCMPGE,
        PFCMPGT,
        PFCPIT1,
        PFMAX,
        PFMIN,
        PFMUL,
        PFNACC,
        PFPNACC,
        PFRCP,
        PFRCPIT2,
        PFRSQIT1,
        PFSQRT,
        PFSUB,
        PFSUBR,
        PHADDD,
        PHADDSW,
        PHADDW,
        PHMINPOSUW,
        PHSUBD,
        PHSUBSW,
        PHSUBW,
        PI2FD,
        PI2FW,
        PINSRB,
        PINSRD,
        PINSRQ,
        PINSRW,
        PMADDUBSW,
        PMADDWD,
        PMAXSB,
        PMAXSD,
        PMAXSW,
        PMAXUB,
        PMAXUD,
        PMAXUW,
        PMINSB,
        PMINSD,
        PMINSW,
        PMINUB,
        PMINUD,
        PMINUW,
        PMOVMSKB,
        PMOVSXBD,
        PMOVSXBQ,
        PMOVSXBW,
        PMOVSXDQ,
        PMOVSXWD,
        PMOVSXWQ,
        PMOVZXBD,
        PMOVZXBQ,
        PMOVZXBW,
        PMOVZXDQ,
        PMOVZXWD,
        PMOVZXWQ,
        PMULDQ,
        PMULHRSW,
        PMULHRW,
        PMULHUW,
        PMULHW,
        PMULLD,
        PMULLW,
        PMULUDQ,
        POP,
        POPA,
        POPAD,
        POPCNT,
        POPF,
        POPFD,
        POPFQ,
        POR,
        PREFETCH,
        PREFETCHNTA,
        PREFETCHT0,
        PREFETCHT1,
        PREFETCHT2,
        PREFETCHW,
        PREFETCHWT1,
        PSADBW,
        PSHUFB,
        PSHUFD,
        PSHUFHW,
        PSHUFLW,
        PSHUFW,
        PSIGNB,
        PSIGND,
        PSIGNW,
        PSLLD,
        PSLLDQ,
        PSLLQ,
        PSLLW,
        PSRAD,
        PSRAW,
        PSRLD,
        PSRLDQ,
        PSRLQ,
        PSRLW,
        PSUBB,
        PSUBD,
        PSUBQ,
        PSUBSB,
        PSUBSW,
        PSUBUSB,
        PSUBUSW,
        PSUBW,
        PSWAPD,
        PTEST,
        PTWRITE,
        PUNPCKHBW,
        PUNPCKHDQ,
        PUNPCKHQDQ,
        PUNPCKHWD,
        PUNPCKLBW,
        PUNPCKLDQ,
        PUNPCKLQDQ,
        PUNPCKLWD,
        PUSH,
        PUSHA,
        PUSHAD,
        PUSHF,
        PUSHFD,
        PUSHFQ,
        PXOR,
        RCL,
        RCPPS,
        RCPSS,
        RCR,
        RDFSBASE,
        RDGSBASE,
        RDMSR,
        RDPID,
        RDPKRU,
        RDPMC,
        RDPRU,
        RDRAND,
        RDSEED,
        RDSSPD,
        RDSSPQ,
        RDTSC,
        RDTSCP,
        RET,
        ROL,
        ROR,
        RORX,
        ROUNDPD,
        ROUNDPS,
        ROUNDSD,
        ROUNDSS,
        RSM,
        RSQRTPS,
        RSQRTSS,
        RSTORSSP,
        SAHF,
        SALC,
        SAR,
        SARX,
        SAVEPREVSSP,
        SBB,
        SCASB,
        SCASD,
        SCASQ,
        SCASW,
        SETB,
        SETBE,
        SETL,
        SETLE,
        SETNB,
        SETNBE,
        SETNL,
        SETNLE,
        SETNO,
        SETNP,
        SETNS,
        SETNZ,
        SETO,
        SETP,
        SETS,
        SETSSBSY,
        SETZ,
        SFENCE,
        SGDT,
        SHA1MSG1,
        SHA1MSG2,
        SHA1NEXTE,
        SHA1RNDS4,
        SHA256MSG1,
        SHA256MSG2,
        SHA256RNDS2,
        SHL,
        SHLD,
        SHLX,
        SHR,
        SHRD,
        SHRX,
        SHUFPD,
        SHUFPS,
        SIDT,
        SKINIT,
        SLDT,
        SLWPCB,
        SMSW,
        SPFLT,
        SQRTPD,
        SQRTPS,
        SQRTSD,
        SQRTSS,
        STAC,
        STC,
        STD,
        STGI,
        STI,
        STMXCSR,
        STOSB,
        STOSD,
        STOSQ,
        STOSW,
        STR,
        SUB,
        SUBPD,
        SUBPS,
        SUBSD,
        SUBSS,
        SWAPGS,
        SYSCALL,
        SYSENTER,
        SYSEXIT,
        SYSRET,
        T1MSKC,
        TEST,
        TPAUSE,
        TZCNT,
        TZCNTI,
        TZMSK,
        UCOMISD,
        UCOMISS,
        UD0,
        UD1,
        UD2,
        UMONITOR,
        UMWAIT,
        UNPCKHPD,
        UNPCKHPS,
        UNPCKLPD,
        UNPCKLPS,
        V4FMADDPS,
        V4FMADDSS,
        V4FNMADDPS,
        V4FNMADDSS,
        VADDNPD,
        VADDNPS,
        VADDPD,
        VADDPS,
        VADDSD,
        VADDSETSPS,
        VADDSS,
        VADDSUBPD,
        VADDSUBPS,
        VAESDEC,
        VAESDECLAST,
        VAESENC,
        VAESENCLAST,
        VAESIMC,
        VAESKEYGENASSIST,
        VALIGND,
        VALIGNQ,
        VANDNPD,
        VANDNPS,
        VANDPD,
        VANDPS,
        VBLENDMPD,
        VBLENDMPS,
        VBLENDPD,
        VBLENDPS,
        VBLENDVPD,
        VBLENDVPS,
        VBROADCASTF128,
        VBROADCASTF32X2,
        VBROADCASTF32X4,
        VBROADCASTF32X8,
        VBROADCASTF64X2,
        VBROADCASTF64X4,
        VBROADCASTI128,
        VBROADCASTI32X2,
        VBROADCASTI32X4,
        VBROADCASTI32X8,
        VBROADCASTI64X2,
        VBROADCASTI64X4,
        VBROADCASTSD,
        VBROADCASTSS,
        VCMPPD,
        VCMPPS,
        VCMPSD,
        VCMPSS,
        VCOMISD,
        VCOMISS,
        VCOMPRESSPD,
        VCOMPRESSPS,
        VCVTDQ2PD,
        VCVTDQ2PS,
        VCVTFXPNTDQ2PS,
        VCVTFXPNTPD2DQ,
        VCVTFXPNTPD2UDQ,
        VCVTFXPNTPS2DQ,
        VCVTFXPNTPS2UDQ,
        VCVTFXPNTUDQ2PS,
        VCVTNE2PS2BF16,
        VCVTNEPS2BF16,
        VCVTPD2DQ,
        VCVTPD2PS,
        VCVTPD2QQ,
        VCVTPD2UDQ,
        VCVTPD2UQQ,
        VCVTPH2PS,
        VCVTPS2DQ,
        VCVTPS2PD,
        VCVTPS2PH,
        VCVTPS2QQ,
        VCVTPS2UDQ,
        VCVTPS2UQQ,
        VCVTQQ2PD,
        VCVTQQ2PS,
        VCVTSD2SI,
        VCVTSD2SS,
        VCVTSD2USI,
        VCVTSI2SD,
        VCVTSI2SS,
        VCVTSS2SD,
        VCVTSS2SI,
        VCVTSS2USI,
        VCVTTPD2DQ,
        VCVTTPD2QQ,
        VCVTTPD2UDQ,
        VCVTTPD2UQQ,
        VCVTTPS2DQ,
        VCVTTPS2QQ,
        VCVTTPS2UDQ,
        VCVTTPS2UQQ,
        VCVTTSD2SI,
        VCVTTSD2USI,
        VCVTTSS2SI,
        VCVTTSS2USI,
        VCVTUDQ2PD,
        VCVTUDQ2PS,
        VCVTUQQ2PD,
        VCVTUQQ2PS,
        VCVTUSI2SD,
        VCVTUSI2SS,
        VDBPSADBW,
        VDIVPD,
        VDIVPS,
        VDIVSD,
        VDIVSS,
        VDPBF16PS,
        VDPPD,
        VDPPS,
        VERR,
        VERW,
        VEXP223PS,
        VEXP2PD,
        VEXP2PS,
        VEXPANDPD,
        VEXPANDPS,
        VEXTRACTF128,
        VEXTRACTF32X4,
        VEXTRACTF32X8,
        VEXTRACTF64X2,
        VEXTRACTF64X4,
        VEXTRACTI128,
        VEXTRACTI32X4,
        VEXTRACTI32X8,
        VEXTRACTI64X2,
        VEXTRACTI64X4,
        VEXTRACTPS,
        VFIXUPIMMPD,
        VFIXUPIMMPS,
        VFIXUPIMMSD,
        VFIXUPIMMSS,
        VFIXUPNANPD,
        VFIXUPNANPS,
        VFMADD132PD,
        VFMADD132PS,
        VFMADD132SD,
        VFMADD132SS,
        VFMADD213PD,
        VFMADD213PS,
        VFMADD213SD,
        VFMADD213SS,
        VFMADD231PD,
        VFMADD231PS,
        VFMADD231SD,
        VFMADD231SS,
        VFMADD233PS,
        VFMADDPD,
        VFMADDPS,
        VFMADDSD,
        VFMADDSS,
        VFMADDSUB132PD,
        VFMADDSUB132PS,
        VFMADDSUB213PD,
        VFMADDSUB213PS,
        VFMADDSUB231PD,
        VFMADDSUB231PS,
        VFMADDSUBPD,
        VFMADDSUBPS,
        VFMSUB132PD,
        VFMSUB132PS,
        VFMSUB132SD,
        VFMSUB132SS,
        VFMSUB213PD,
        VFMSUB213PS,
        VFMSUB213SD,
        VFMSUB213SS,
        VFMSUB231PD,
        VFMSUB231PS,
        VFMSUB231SD,
        VFMSUB231SS,
        VFMSUBADD132PD,
        VFMSUBADD132PS,
        VFMSUBADD213PD,
        VFMSUBADD213PS,
        VFMSUBADD231PD,
        VFMSUBADD231PS,
        VFMSUBADDPD,
        VFMSUBADDPS,
        VFMSUBPD,
        VFMSUBPS,
        VFMSUBSD,
        VFMSUBSS,
        VFNMADD132PD,
        VFNMADD132PS,
        VFNMADD132SD,
        VFNMADD132SS,
        VFNMADD213PD,
        VFNMADD213PS,
        VFNMADD213SD,
        VFNMADD213SS,
        VFNMADD231PD,
        VFNMADD231PS,
        VFNMADD231SD,
        VFNMADD231SS,
        VFNMADDPD,
        VFNMADDPS,
        VFNMADDSD,
        VFNMADDSS,
        VFNMSUB132PD,
        VFNMSUB132PS,
        VFNMSUB132SD,
        VFNMSUB132SS,
        VFNMSUB213PD,
        VFNMSUB213PS,
        VFNMSUB213SD,
        VFNMSUB213SS,
        VFNMSUB231PD,
        VFNMSUB231PS,
        VFNMSUB231SD,
        VFNMSUB231SS,
        VFNMSUBPD,
        VFNMSUBPS,
        VFNMSUBSD,
        VFNMSUBSS,
        VFPCLASSPD,
        VFPCLASSPS,
        VFPCLASSSD,
        VFPCLASSSS,
        VFRCZPD,
        VFRCZPS,
        VFRCZSD,
        VFRCZSS,
        VGATHERDPD,
        VGATHERDPS,
        VGATHERPF0DPD,
        VGATHERPF0DPS,
        VGATHERPF0HINTDPD,
        VGATHERPF0HINTDPS,
        VGATHERPF0QPD,
        VGATHERPF0QPS,
        VGATHERPF1DPD,
        VGATHERPF1DPS,
        VGATHERPF1QPD,
        VGATHERPF1QPS,
        VGATHERQPD,
        VGATHERQPS,
        VGETEXPPD,
        VGETEXPPS,
        VGETEXPSD,
        VGETEXPSS,
        VGETMANTPD,
        VGETMANTPS,
        VGETMANTSD,
        VGETMANTSS,
        VGF2P8AFFINEINVQB,
        VGF2P8AFFINEQB,
        VGF2P8MULB,
        VGMAXABSPS,
        VGMAXPD,
        VGMAXPS,
        VGMINPD,
        VGMINPS,
        VHADDPD,
        VHADDPS,
        VHSUBPD,
        VHSUBPS,
        VINSERTF128,
        VINSERTF32X4,
        VINSERTF32X8,
        VINSERTF64X2,
        VINSERTF64X4,
        VINSERTI128,
        VINSERTI32X4,
        VINSERTI32X8,
        VINSERTI64X2,
        VINSERTI64X4,
        VINSERTPS,
        VLDDQU,
        VLDMXCSR,
        VLOADUNPACKHD,
        VLOADUNPACKHPD,
        VLOADUNPACKHPS,
        VLOADUNPACKHQ,
        VLOADUNPACKLD,
        VLOADUNPACKLPD,
        VLOADUNPACKLPS,
        VLOADUNPACKLQ,
        VLOG2PS,
        VMASKMOVDQU,
        VMASKMOVPD,
        VMASKMOVPS,
        VMAXPD,
        VMAXPS,
        VMAXSD,
        VMAXSS,
        VMCALL,
        VMCLEAR,
        VMFUNC,
        VMINPD,
        VMINPS,
        VMINSD,
        VMINSS,
        VMLAUNCH,
        VMLOAD,
        VMMCALL,
        VMOVAPD,
        VMOVAPS,
        VMOVD,
        VMOVDDUP,
        VMOVDQA,
        VMOVDQA32,
        VMOVDQA64,
        VMOVDQU,
        VMOVDQU16,
        VMOVDQU32,
        VMOVDQU64,
        VMOVDQU8,
        VMOVHLPS,
        VMOVHPD,
        VMOVHPS,
        VMOVLHPS,
        VMOVLPD,
        VMOVLPS,
        VMOVMSKPD,
        VMOVMSKPS,
        VMOVNRAPD,
        VMOVNRAPS,
        VMOVNRNGOAPD,
        VMOVNRNGOAPS,
        VMOVNTDQ,
        VMOVNTDQA,
        VMOVNTPD,
        VMOVNTPS,
        VMOVQ,
        VMOVSD,
        VMOVSHDUP,
        VMOVSLDUP,
        VMOVSS,
        VMOVUPD,
        VMOVUPS,
        VMPSADBW,
        VMPTRLD,
        VMPTRST,
        VMREAD,
        VMRESUME,
        VMRUN,
        VMSAVE,
        VMULPD,
        VMULPS,
        VMULSD,
        VMULSS,
        VMWRITE,
        VMXOFF,
        VMXON,
        VORPD,
        VORPS,
        VP2INTERSECTD,
        VP2INTERSECTQ,
        VP4DPWSSD,
        VP4DPWSSDS,
        VPABSB,
        VPABSD,
        VPABSQ,
        VPABSW,
        VPACKSSDW,
        VPACKSSWB,
        VPACKSTOREHD,
        VPACKSTOREHPD,
        VPACKSTOREHPS,
        VPACKSTOREHQ,
        VPACKSTORELD,
        VPACKSTORELPD,
        VPACKSTORELPS,
        VPACKSTORELQ,
        VPACKUSDW,
        VPACKUSWB,
        VPADCD,
        VPADDB,
        VPADDD,
        VPADDQ,
        VPADDSB,
        VPADDSETCD,
        VPADDSETSD,
        VPADDSW,
        VPADDUSB,
        VPADDUSW,
        VPADDW,
        VPALIGNR,
        VPAND,
        VPANDD,
        VPANDN,
        VPANDND,
        VPANDNQ,
        VPANDQ,
        VPAVGB,
        VPAVGW,
        VPBLENDD,
        VPBLENDMB,
        VPBLENDMD,
        VPBLENDMQ,
        VPBLENDMW,
        VPBLENDVB,
        VPBLENDW,
        VPBROADCASTB,
        VPBROADCASTD,
        VPBROADCASTMB2Q,
        VPBROADCASTMW2D,
        VPBROADCASTQ,
        VPBROADCASTW,
        VPCLMULQDQ,
        VPCMOV,
        VPCMPB,
        VPCMPD,
        VPCMPEQB,
        VPCMPEQD,
        VPCMPEQQ,
        VPCMPEQW,
        VPCMPESTRI,
        VPCMPESTRM,
        VPCMPGTB,
        VPCMPGTD,
        VPCMPGTQ,
        VPCMPGTW,
        VPCMPISTRI,
        VPCMPISTRM,
        VPCMPLTD,
        VPCMPQ,
        VPCMPUB,
        VPCMPUD,
        VPCMPUQ,
        VPCMPUW,
        VPCMPW,
        VPCOMB,
        VPCOMD,
        VPCOMPRESSB,
        VPCOMPRESSD,
        VPCOMPRESSQ,
        VPCOMPRESSW,
        VPCOMQ,
        VPCOMUB,
        VPCOMUD,
        VPCOMUQ,
        VPCOMUW,
        VPCOMW,
        VPCONFLICTD,
        VPCONFLICTQ,
        VPDPBUSD,
        VPDPBUSDS,
        VPDPWSSD,
        VPDPWSSDS,
        VPERM2F128,
        VPERM2I128,
        VPERMB,
        VPERMD,
        VPERMF32X4,
        VPERMI2B,
        VPERMI2D,
        VPERMI2PD,
        VPERMI2PS,
        VPERMI2Q,
        VPERMI2W,
        VPERMIL2PD,
        VPERMIL2PS,
        VPERMILPD,
        VPERMILPS,
        VPERMPD,
        VPERMPS,
        VPERMQ,
        VPERMT2B,
        VPERMT2D,
        VPERMT2PD,
        VPERMT2PS,
        VPERMT2Q,
        VPERMT2W,
        VPERMW,
        VPEXPANDB,
        VPEXPANDD,
        VPEXPANDQ,
        VPEXPANDW,
        VPEXTRB,
        VPEXTRD,
        VPEXTRQ,
        VPEXTRW,
        VPGATHERDD,
        VPGATHERDQ,
        VPGATHERQD,
        VPGATHERQQ,
        VPHADDBD,
        VPHADDBQ,
        VPHADDBW,
        VPHADDD,
        VPHADDDQ,
        VPHADDSW,
        VPHADDUBD,
        VPHADDUBQ,
        VPHADDUBW,
        VPHADDUDQ,
        VPHADDUWD,
        VPHADDUWQ,
        VPHADDW,
        VPHADDWD,
        VPHADDWQ,
        VPHMINPOSUW,
        VPHSUBBW,
        VPHSUBD,
        VPHSUBDQ,
        VPHSUBSW,
        VPHSUBW,
        VPHSUBWD,
        VPINSRB,
        VPINSRD,
        VPINSRQ,
        VPINSRW,
        VPLZCNTD,
        VPLZCNTQ,
        VPMACSDD,
        VPMACSDQH,
        VPMACSDQL,
        VPMACSSDD,
        VPMACSSDQH,
        VPMACSSDQL,
        VPMACSSWD,
        VPMACSSWW,
        VPMACSWD,
        VPMACSWW,
        VPMADCSSWD,
        VPMADCSWD,
        VPMADD231D,
        VPMADD233D,
        VPMADD52HUQ,
        VPMADD52LUQ,
        VPMADDUBSW,
        VPMADDWD,
        VPMASKMOVD,
        VPMASKMOVQ,
        VPMAXSB,
        VPMAXSD,
        VPMAXSQ,
        VPMAXSW,
        VPMAXUB,
        VPMAXUD,
        VPMAXUQ,
        VPMAXUW,
        VPMINSB,
        VPMINSD,
        VPMINSQ,
        VPMINSW,
        VPMINUB,
        VPMINUD,
        VPMINUQ,
        VPMINUW,
        VPMOVB2M,
        VPMOVD2M,
        VPMOVDB,
        VPMOVDW,
        VPMOVM2B,
        VPMOVM2D,
        VPMOVM2Q,
        VPMOVM2W,
        VPMOVMSKB,
        VPMOVQ2M,
        VPMOVQB,
        VPMOVQD,
        VPMOVQW,
        VPMOVSDB,
        VPMOVSDW,
        VPMOVSQB,
        VPMOVSQD,
        VPMOVSQW,
        VPMOVSWB,
        VPMOVSXBD,
        VPMOVSXBQ,
        VPMOVSXBW,
        VPMOVSXDQ,
        VPMOVSXWD,
        VPMOVSXWQ,
        VPMOVUSDB,
        VPMOVUSDW,
        VPMOVUSQB,
        VPMOVUSQD,
        VPMOVUSQW,
        VPMOVUSWB,
        VPMOVW2M,
        VPMOVWB,
        VPMOVZXBD,
        VPMOVZXBQ,
        VPMOVZXBW,
        VPMOVZXDQ,
        VPMOVZXWD,
        VPMOVZXWQ,
        VPMULDQ,
        VPMULHD,
        VPMULHRSW,
        VPMULHUD,
        VPMULHUW,
        VPMULHW,
        VPMULLD,
        VPMULLQ,
        VPMULLW,
        VPMULTISHIFTQB,
        VPMULUDQ,
        VPOPCNTB,
        VPOPCNTD,
        VPOPCNTQ,
        VPOPCNTW,
        VPOR,
        VPORD,
        VPORQ,
        VPPERM,
        VPREFETCH0,
        VPREFETCH1,
        VPREFETCH2,
        VPREFETCHE0,
        VPREFETCHE1,
        VPREFETCHE2,
        VPREFETCHENTA,
        VPREFETCHNTA,
        VPROLD,
        VPROLQ,
        VPROLVD,
        VPROLVQ,
        VPRORD,
        VPRORQ,
        VPRORVD,
        VPRORVQ,
        VPROTB,
        VPROTD,
        VPROTQ,
        VPROTW,
        VPSADBW,
        VPSBBD,
        VPSBBRD,
        VPSCATTERDD,
        VPSCATTERDQ,
        VPSCATTERQD,
        VPSCATTERQQ,
        VPSHAB,
        VPSHAD,
        VPSHAQ,
        VPSHAW,
        VPSHLB,
        VPSHLD,
        VPSHLDD,
        VPSHLDQ,
        VPSHLDVD,
        VPSHLDVQ,
        VPSHLDVW,
        VPSHLDW,
        VPSHLQ,
        VPSHLW,
        VPSHRDD,
        VPSHRDQ,
        VPSHRDVD,
        VPSHRDVQ,
        VPSHRDVW,
        VPSHRDW,
        VPSHUFB,
        VPSHUFBITQMB,
        VPSHUFD,
        VPSHUFHW,
        VPSHUFLW,
        VPSIGNB,
        VPSIGND,
        VPSIGNW,
        VPSLLD,
        VPSLLDQ,
        VPSLLQ,
        VPSLLVD,
        VPSLLVQ,
        VPSLLVW,
        VPSLLW,
        VPSRAD,
        VPSRAQ,
        VPSRAVD,
        VPSRAVQ,
        VPSRAVW,
        VPSRAW,
        VPSRLD,
        VPSRLDQ,
        VPSRLQ,
        VPSRLVD,
        VPSRLVQ,
        VPSRLVW,
        VPSRLW,
        VPSUBB,
        VPSUBD,
        VPSUBQ,
        VPSUBRD,
        VPSUBRSETBD,
        VPSUBSB,
        VPSUBSETBD,
        VPSUBSW,
        VPSUBUSB,
        VPSUBUSW,
        VPSUBW,
        VPTERNLOGD,
        VPTERNLOGQ,
        VPTEST,
        VPTESTMB,
        VPTESTMD,
        VPTESTMQ,
        VPTESTMW,
        VPTESTNMB,
        VPTESTNMD,
        VPTESTNMQ,
        VPTESTNMW,
        VPUNPCKHBW,
        VPUNPCKHDQ,
        VPUNPCKHQDQ,
        VPUNPCKHWD,
        VPUNPCKLBW,
        VPUNPCKLDQ,
        VPUNPCKLQDQ,
        VPUNPCKLWD,
        VPXOR,
        VPXORD,
        VPXORQ,
        VRANGEPD,
        VRANGEPS,
        VRANGESD,
        VRANGESS,
        VRCP14PD,
        VRCP14PS,
        VRCP14SD,
        VRCP14SS,
        VRCP23PS,
        VRCP28PD,
        VRCP28PS,
        VRCP28SD,
        VRCP28SS,
        VRCPPS,
        VRCPSS,
        VREDUCEPD,
        VREDUCEPS,
        VREDUCESD,
        VREDUCESS,
        VRNDFXPNTPD,
        VRNDFXPNTPS,
        VRNDSCALEPD,
        VRNDSCALEPS,
        VRNDSCALESD,
        VRNDSCALESS,
        VROUNDPD,
        VROUNDPS,
        VROUNDSD,
        VROUNDSS,
        VRSQRT14PD,
        VRSQRT14PS,
        VRSQRT14SD,
        VRSQRT14SS,
        VRSQRT23PS,
        VRSQRT28PD,
        VRSQRT28PS,
        VRSQRT28SD,
        VRSQRT28SS,
        VRSQRTPS,
        VRSQRTSS,
        VSCALEFPD,
        VSCALEFPS,
        VSCALEFSD,
        VSCALEFSS,
        VSCALEPS,
        VSCATTERDPD,
        VSCATTERDPS,
        VSCATTERPF0DPD,
        VSCATTERPF0DPS,
        VSCATTERPF0HINTDPD,
        VSCATTERPF0HINTDPS,
        VSCATTERPF0QPD,
        VSCATTERPF0QPS,
        VSCATTERPF1DPD,
        VSCATTERPF1DPS,
        VSCATTERPF1QPD,
        VSCATTERPF1QPS,
        VSCATTERQPD,
        VSCATTERQPS,
        VSHUFF32X4,
        VSHUFF64X2,
        VSHUFI32X4,
        VSHUFI64X2,
        VSHUFPD,
        VSHUFPS,
        VSQRTPD,
        VSQRTPS,
        VSQRTSD,
        VSQRTSS,
        VSTMXCSR,
        VSUBPD,
        VSUBPS,
        VSUBRPD,
        VSUBRPS,
        VSUBSD,
        VSUBSS,
        VTESTPD,
        VTESTPS,
        VUCOMISD,
        VUCOMISS,
        VUNPCKHPD,
        VUNPCKHPS,
        VUNPCKLPD,
        VUNPCKLPS,
        VXORPD,
        VXORPS,
        VZEROALL,
        VZEROUPPER,
        WBINVD,
        WRFSBASE,
        WRGSBASE,
        WRMSR,
        WRPKRU,
        WRSSD,
        WRSSQ,
        WRUSSD,
        WRUSSQ,
        XABORT,
        XADD,
        XBEGIN,
        XCHG,
        XCRYPT_CBC,
        XCRYPT_CFB,
        XCRYPT_CTR,
        XCRYPT_ECB,
        XCRYPT_OFB,
        XEND,
        XGETBV,
        XLAT,
        XOR,
        XORPD,
        XORPS,
        XRSTOR,
        XRSTOR64,
        XRSTORS,
        XRSTORS64,
        XSAVE,
        XSAVE64,
        XSAVEC,
        XSAVEC64,
        XSAVEOPT,
        XSAVEOPT64,
        XSAVES,
        XSAVES64,
        XSETBV,
        XSHA1,
        XSHA256,
        XSTORE,
        XTEST,
	};

	enum struct Register
	{
        NONE,

        // General purpose registers  8-bit
        AL,
        CL,
        DL,
        BL,
        AH,
        CH,
        DH,
        BH,
        SPL,
        BPL,
        SIL,
        DIL,
        R8B,
        R9B,
        R10B,
        R11B,
        R12B,
        R13B,
        R14B,
        R15B,
        // General purpose registers 16-bit
        AX,
        CX,
        DX,
        BX,
        SP,
        BP,
        SI,
        DI,
        R8W,
        R9W,
        R10W,
        R11W,
        R12W,
        R13W,
        R14W,
        R15W,
        // General purpose registers 32-bit
        EAX,
        ECX,
        EDX,
        EBX,
        ESP,
        EBP,
        ESI,
        EDI,
        R8D,
        R9D,
        R10D,
        R11D,
        R12D,
        R13D,
        R14D,
        R15D,
        // General purpose registers 64-bit
        RAX,
        RCX,
        RDX,
        RBX,
        RSP,
        RBP,
        RSI,
        RDI,
        R8,
        R9,
        R10,
        R11,
        R12,
        R13,
        R14,
        R15,
        // Floating point legacy registers
        ST0,
        ST1,
        ST2,
        ST3,
        ST4,
        ST5,
        ST6,
        ST7,
        X87CONTROL,
        X87STATUS,
        X87TAG,
        // Floating point multimedia registers
        MM0,
        MM1,
        MM2,
        MM3,
        MM4,
        MM5,
        MM6,
        MM7,
        // Floating point vector registers 128-bit
        XMM0,
        XMM1,
        XMM2,
        XMM3,
        XMM4,
        XMM5,
        XMM6,
        XMM7,
        XMM8,
        XMM9,
        XMM10,
        XMM11,
        XMM12,
        XMM13,
        XMM14,
        XMM15,
        XMM16,
        XMM17,
        XMM18,
        XMM19,
        XMM20,
        XMM21,
        XMM22,
        XMM23,
        XMM24,
        XMM25,
        XMM26,
        XMM27,
        XMM28,
        XMM29,
        XMM30,
        XMM31,
        // Floating point vector registers 256-bit
        YMM0,
        YMM1,
        YMM2,
        YMM3,
        YMM4,
        YMM5,
        YMM6,
        YMM7,
        YMM8,
        YMM9,
        YMM10,
        YMM11,
        YMM12,
        YMM13,
        YMM14,
        YMM15,
        YMM16,
        YMM17,
        YMM18,
        YMM19,
        YMM20,
        YMM21,
        YMM22,
        YMM23,
        YMM24,
        YMM25,
        YMM26,
        YMM27,
        YMM28,
        YMM29,
        YMM30,
        YMM31,
        // Floating point vector registers 512-bit
        ZMM0,
        ZMM1,
        ZMM2,
        ZMM3,
        ZMM4,
        ZMM5,
        ZMM6,
        ZMM7,
        ZMM8,
        ZMM9,
        ZMM10,
        ZMM11,
        ZMM12,
        ZMM13,
        ZMM14,
        ZMM15,
        ZMM16,
        ZMM17,
        ZMM18,
        ZMM19,
        ZMM20,
        ZMM21,
        ZMM22,
        ZMM23,
        ZMM24,
        ZMM25,
        ZMM26,
        ZMM27,
        ZMM28,
        ZMM29,
        ZMM30,
        ZMM31,
        // Flags registers
        FLAGS,
        EFLAGS,
        RFLAGS,
        // Instruction-pointer registers
        IP,
        EIP,
        RIP,
        // Segment registers
        ES,
        CS,
        SS,
        DS,
        FS,
        GS,
        // Table registers
        GDTR,
        LDTR,
        IDTR,
        TR,
        // Test registers
        TR0,
        TR1,
        TR2,
        TR3,
        TR4,
        TR5,
        TR6,
        TR7,
        // Control registers
        CR0,
        CR1,
        CR2,
        CR3,
        CR4,
        CR5,
        CR6,
        CR7,
        CR8,
        CR9,
        CR10,
        CR11,
        CR12,
        CR13,
        CR14,
        CR15,
        // Debug registers
        DR0,
        DR1,
        DR2,
        DR3,
        DR4,
        DR5,
        DR6,
        DR7,
        DR8,
        DR9,
        DR10,
        DR11,
        DR12,
        DR13,
        DR14,
        DR15,
        // Mask registers
        K0,
        K1,
        K2,
        K3,
        K4,
        K5,
        K6,
        K7,
        // Bound registers
        BND0,
        BND1,
        BND2,
        BND3,
        BNDCFG,
        BNDSTATUS,
        // Uncategorized
        MXCSR,
        PKRU,
        XCR0,
	};

	enum struct OperandType
	{
        UNUSED,
		REGISTER,
		MEM
	};

    struct Memory
    {
        Register base;
        Register index;
    };

	struct Operand
	{
        union
        {
            Register reg;
            Memory mem;
        };
		OperandType type;
		// true if this operand is read by the instruction
		bool read;
		// true if this operand is written by the instruction
		bool write;
	};

	struct Instruction
	{
		Mnemonic mnemonic;
        // If operand.reg is NONE, it means this and any operands after this are not in use.
		Operand operands[10];
		char length;
	};

    // <disassembly text, instruction address>
    using DisassemblyText = std::pair<std::string, std::int64_t>;
    using Disassembly = std::pair<Instruction, std::int64_t>;

    struct DisassemblyResult
    {
        std::vector<std::int64_t> functions;
        std::vector<DisassemblyText> disassembly_text;
        std::vector<Disassembly> disassembly;

        DisassemblyResult() = default;
        DisassemblyResult(DisassemblyResult&) = delete;
        DisassemblyResult& operator=(const DisassemblyResult&) = delete;
        DisassemblyResult(DisassemblyResult&&) = default;
        EXPORT_API ~DisassemblyResult();
    };

	struct FileData
	{
		std::vector<Section> sections;
		Disassembler* internal_data = nullptr;

        FileData() = default;
        FileData(FileData&) = delete;
        FileData& operator=(const FileData&) = delete;
        FileData(FileData&& rhs):
            sections(std::move(rhs.sections)),
            internal_data(rhs.internal_data)
        {
            rhs.internal_data = nullptr;
        }

		EXPORT_API DisassemblyResult Disassemble(std::int64_t start, std::int64_t end, bool return_string);
		EXPORT_API ~FileData();
	};

	/// <summary>
	/// Call this function first and call it only once. 
	/// This function initializes data and loads models.
	/// </summary>
    EXPORT_API void Initialize(const char* key);


	/// <summary>
	/// Open a binary at given path
	/// </summary>
	/// <param name="path">path to the binary file</param>
	EXPORT_API FileData Open(const char* path);

	/// <summary>
	/// This function offloads models and frees memory.
	/// </summary>
	/// <returns></returns>
	EXPORT_API void Release();
}